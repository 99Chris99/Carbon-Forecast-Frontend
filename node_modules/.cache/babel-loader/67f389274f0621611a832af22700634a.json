{"ast":null,"code":"import _toConsumableArray from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/Chris/Development/Final-Project/carbon-forecast-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import logo from\"./logo.svg\";import{BrowserRouter as Router,Switch,Route}from\"react-router-dom\";import'./App.css';import API from'./adapters/API';import Nav from'./components/Nav';import Start from'./components/Start';import Forecast from'./components/Forecast';import Timeline from'./components/Timeline';import Hero from'./components/Hero';import About from'./components/About';import Advice from'./components/Advice';import FuelMix from'./components/FuelMix';import Footer from'./components/Footer';import ScrollToTop from'./components/ScrollToTop';import{ItemMeta,Header,Transition}from'semantic-ui-react';import{cloneWithoutLoc}from'@babel/types';import{Container}from'semantic-ui-react';export var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);function App(){var _getPrototypeOf2;var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(App)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={mobileUser:false,screenWidth:400,setRegion:18,setPostCode:'',useId:true,setPeriod:12,setGran:2,mediumVal:150,middle:150,emissions:0,regionIndex:[],currentLevel:{region:'',text:'',value:0},forecastA:{},forecastB:{},forecastC:{},aggedVals:[],bestPeriods:{},fuelMix:[],timelineVals:[],loading:true,currentRegionName:'GB'};_this.now=function(){var date=new Date();return date.toISOString();};_this.viewport=function(){var e=window;var a='inner';if(!('innerWidth'in window)){a='client';e=document.documentElement||document.body;}var dimentions={width:e[a+'Width'],height:e[a+'Height']};_this.setState({screenWidth:dimentions.width});if(dimentions.width<600){_this.setState({mobileUser:true});}};_this.calMediumLevel=function(){var set=_this.state.timelineVals.map(function(item){return item.level;});var sum=set.reduce(function(acc,cur){return acc+cur;});//console.log(sum)\nvar avg=sum/set.length;_this.setState({mediumVal:Math.round(avg)});};_this.calMiddle=function(){var set=_this.state.timelineVals.map(function(item){return item.level;});var big=set.reduce(function(acc,cur){if(cur>acc){acc=cur;}});//console.log(sum)\nvar avg=big/2;_this.setState({middle:Math.round(avg)});};_this.plus30Mins=function(dateTime){var newTime=dateTime.split(/\\D+/);var output=new Date(Date.UTC(newTime[0],newTime[1]-1,newTime[2],newTime[3],newTime[4],newTime[5]));output.setMinutes(output.getMinutes()+30);var newdateTime=output.toISOString();return newdateTime;};_this.loading=function(){if(typeof _this.state.forecastC[0]==='undefined'){console.log('loading check');_this.setState({loading:true});}else{_this.setState({loading:false});}};_this.countEmmissions=function(){var count=_this.state.emissions+=0.0142;_this.setState({emissions:count});};_this.get48hForecast=function(start,useID){if(_this.state.useId&&useID){_this.setState({loading:true});API.getRegionId48HrsData(_this.state.setRegion,start).then(function(info){return _this.setState({forecastA:info.data.data});});}else{// API.getRegionPostCode48HrsData(this.state.setPostCode, start).then(info => this.setState({forecastA: info.data.data}, {setRegion: info.data.regionid}))\n_this.setState({loading:true});API.getRegionPostCode48HrsData(_this.state.setPostCode,start).then(function(info){return _this.setState({forecastA:info.data.data});});}};_this.getForecastB=function(){var start=_this.state.forecastA[_this.state.forecastA.length-1].to;var startPlus30=_this.plus30Mins(start);console.log(startPlus30);if(_this.state.useId){API.getRegionId48HrsData(_this.state.setRegion,startPlus30).then(function(info){return _this.setState({forecastB:info.data.data});});}else{API.getRegionPostCode48HrsData(_this.state.setPostCode,startPlus30).then(function(info){return _this.setState({forecastB:info.data.data});});}};_this.getForecastC=function(){var start=_this.state.forecastB[_this.state.forecastB.length-1].to;var startPlus30=_this.plus30Mins(start);if(_this.state.useId){API.getRegionId48HrsData(_this.state.setRegion,startPlus30).then(function(info){return _this.setState({forecastC:info.data.data,loding:false});});}else{API.getRegionPostCode48HrsData(_this.state.setPostCode,startPlus30).then(function(info){return _this.setState({forecastC:info.data.data,loading:false});});}};_this.compileRegionIndex=function(){_this.setState({regionIndex:[]});API.getCurrentRegionalData().then(function(info){return info.data[0].regions.map(function(item){_this.setState({regionIndex:[].concat(_toConsumableArray(_this.state.regionIndex),[{id:item.regionid,name:item.shortname}])});if(item.regionid===_this.state.setRegion){_this.setState({currentLevel:{region:item.regionid,text:item.intensity.index,value:item.intensity.forecast},currentRegionName:item.shortname});}});}).then(function(datainfo){return console.log(datainfo);});};_this.allForecast=function(){var allForecast=[].concat(_toConsumableArray(_this.state.forecastA),_toConsumableArray(_this.state.forecastB),_toConsumableArray(_this.state.forecastC));return allForecast;};_this.calTextLevel=function(value){if(value>360){return'Very High';}else if(value>=260&&value<=359){return'High';}else if(value>=160&&value<=259){return'Moderate';}else if(value>=60&&value<=159){return'Low';}else if(value<=59&&value>=0){return'Very Low';}else{return'Level not known';}};_this.determinGran=function(){var newGrand=2;if(_this.state.setPeriod<=8){newGrand=2;}else if(_this.state.setPeriod>8&&_this.state.setPeriod<=12){newGrand=2;}else if(_this.state.setPeriod>12&&_this.state.setPeriod<=24){newGrand=2;}else if(_this.state.setPeriod>24&&_this.state.setPeriod<=48){newGrand=2;}else if(_this.state.setPeriod>48&&_this.state.setPeriod<=96){newGrand=4;}else if(_this.state.setPeriod>200){newGrand=6;}_this.setState({setGran:newGrand});return newGrand;};_this.formatFuelMix=function(array){return array.map(function(obj){//return {label: obj.perc > 1 && obj.fuel !== 'biomass' ? obj.fuel : '.   biomass'\n//return {label: obj.perc > 1 ? obj.fuel : ''\nreturn{label:obj.perc>1?obj.fuel==='biomass'?'bio':obj.fuel:'',angle:obj.perc,className:\"\".concat(obj.fuel,\"Wedge\"),tableText:obj.fuel//  ,subLabel: obj.fuel === 'biomass' ? 'biomass' : ''    \n};});};_this.aggForecast=function(inputArray,granularity,timeline){// const period = 8\n// const periodUnits = 'h'\n// const granularity = 4\n// const forecastArray =[2,3,6,1,5,1,1,1,1,1,1,10]\nvar forecastArray=[];var forecastArrayFuelMix=[];if(timeline){forecastArray=_toConsumableArray(inputArray);}else{forecastArray=inputArray.slice(0,_this.state.setPeriod);forecastArrayFuelMix=_toConsumableArray(inputArray);}var agged=[];for(var index=0;index<forecastArray.length;index+=granularity){if(index%granularity===0){var half=forecastArray[index];var set=forecastArray.slice(index,index+granularity).map(function(item){return item.intensity.forecast;});//console.log(set)\nvar sum=set.reduce(function(acc,cur){return acc+cur;});//console.log(sum)\nvar avg=sum/set.length;agged=[].concat(_toConsumableArray(agged),[{from:half.from,level:Math.round(avg),text:_this.calTextLevel(avg)}]);}}var fuelMix=[];for(var _index=0;_index<forecastArrayFuelMix.length;_index+=2){if(_index%2===0){var _half=forecastArrayFuelMix[_index];var _set=forecastArrayFuelMix.slice(_index,_index+2).map(function(item){return item.intensity.forecast;});//console.log(set)\nvar _sum=_set.reduce(function(acc,cur){return acc+cur;});//console.log(sum)\nvar _avg=_sum/_set.length;fuelMix=[].concat(_toConsumableArray(fuelMix),[{date:_half.from,level:Math.round(_avg),text:_this.calTextLevel(_avg),chartData:_this.formatFuelMix(_half.generationmix)}]);}}//let newAgged = agged.slice(0, this.state.setPeriod)\nif(timeline){_this.setState({timelineVals:agged});}else{var best=_this.bestPeriods(agged);_this.setState({aggedVals:agged,bestPeriods:best,fuelMix:fuelMix});}//console.log(agged)\n//return agged\n};_this.bestPeriods=function(objArray){var day=objArray.map(function(item){if(parseInt(item.from.split('T')[1])>=6&&parseInt(item.from.split('T')[1])<=23){return item;}});var night=objArray.map(function(item){if(parseInt(item.from.split('T')[1])<6||parseInt(item.from.split('T')[1])===24){return item;}});var bestDay=day.sort(function(a,b){return a.level>b.level?1:-1;}).slice(0,3);var bestNight=night.sort(function(a,b){return a.level>b.level?1:-1;}).slice(0,3);return{day:bestDay,night:bestNight};};_this.updateRegion=function(newRegion){_this.setState({setRegion:newRegion});};_this.updatePostCode=function(newPostCode){_this.setState({setPostCode:newPostCode});};_this.updatePeriod=function(newPeriod){_this.setState({setPeriod:newPeriod});};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.loading();this.viewport();this.get48hForecast(this.now(),true);this.compileRegionIndex();{setInterval(function(){_this2.countEmmissions();},500);}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){if(this.state.setRegion!==prevState.setRegion){this.get48hForecast(this.now(),true);this.compileRegionIndex();this.setState({useId:true});}else if(this.state.setPostCode!==prevState.setPostCode){this.get48hForecast(this.now(),false);this.setState({useId:false});}else if(this.state.forecastA!==prevState.forecastA){return this.getForecastB(this.state.setRegion);}else if(this.state.forecastB!==prevState.forecastB){return this.getForecastC(this.state.setRegion);}else if(this.state.forecastC!==prevState.forecastC){return this.aggForecast(this.allForecast(),this.determinGran(),false),this.aggForecast(this.allForecast(),2,true),this.loading();}else if(this.state.setPeriod!==prevState.setPeriod){return this.aggForecast(this.allForecast(),this.determinGran());}else if(this.state.timelineVals!==prevState.timelineVals){return this.calMediumLevel(),this.calMiddle();}}},{key:\"render\",value:function render(){return React.createElement(Router,null,React.createElement(ScrollToTop,null),React.createElement(\"div\",null,React.createElement(Hero,{mobileUser:this.state.mobileUser}),React.createElement(Nav,null),React.createElement(\"div\",{style:{display:\"flex\",minHeight:\"100vh\",flexDirection:\"column\"}},React.createElement(\"div\",{style:{flex:1}},React.createElement(Container,{className:\"parentContainer\",style:{maxWidth:'80vw'}},React.createElement(Switch,null,React.createElement(Route,{exact:true,path:\"/\"},React.createElement(Start,{intensityData:this.state.currentLevel,emissions:this.state.emissions.toFixed(4),regionName:this.state.currentRegionName})),React.createElement(Route,{path:\"/start\"},React.createElement(Start,{intensityData:this.state.currentLevel,emissions:this.state.emissions.toFixed(4),regionName:this.state.currentRegionName})),React.createElement(Route,{path:\"/forecast-summary\"},React.createElement(Transition,{visible:true,animation:\"scale\",duration:500},React.createElement(Forecast,{regionIndex:this.state.regionIndex,setRegion:this.state.setRegion,updatePostCode:this.updatePostCode,setPeriod:this.state.setPeriod,updateRegion:this.updateRegion,updatePeriod:this.updatePeriod,aggedVals:this.state.aggedVals,setPostCode:this.state.setPostCode,mobileUser:this.state.mobileUser,bestPeriods:this.state.bestPeriods,loading:this.state.loading,useId:this.state.useId,regionName:this.state.currentRegionName}))),React.createElement(Route,{path:\"/forecast-timeline\"},React.createElement(Timeline,{loading:this.state.loading,timelineVals:this.state.timelineVals,screenWidth:this.state.screenWidth,middleLevel:this.state.middle,mobileUser:this.state.mobileUser})),React.createElement(Route,{path:\"/forecast-fuelmix\"},React.createElement(FuelMix,{loading:this.state.loading,data:this.state.fuelMix,mobileUser:this.state.mobileUser})),React.createElement(Route,{path:\"/about\"},React.createElement(About,null))))),React.createElement(Footer,{emissions:this.state.emissions.toFixed(4)}))));}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/Users/Chris/Development/Final-Project/carbon-forecast-frontend/src/App.js"],"names":["React","Component","BrowserRouter","Router","Switch","Route","API","Nav","Start","Forecast","Timeline","Hero","About","Advice","FuelMix","Footer","ScrollToTop","ItemMeta","Header","Transition","cloneWithoutLoc","Container","App","state","mobileUser","screenWidth","setRegion","setPostCode","useId","setPeriod","setGran","mediumVal","middle","emissions","regionIndex","currentLevel","region","text","value","forecastA","forecastB","forecastC","aggedVals","bestPeriods","fuelMix","timelineVals","loading","currentRegionName","now","date","Date","toISOString","viewport","e","window","a","document","documentElement","body","dimentions","width","height","setState","calMediumLevel","set","map","item","level","sum","reduce","acc","cur","avg","length","Math","round","calMiddle","big","plus30Mins","dateTime","newTime","split","output","UTC","setMinutes","getMinutes","newdateTime","console","log","countEmmissions","count","get48hForecast","start","useID","getRegionId48HrsData","then","info","data","getRegionPostCode48HrsData","getForecastB","to","startPlus30","getForecastC","loding","compileRegionIndex","getCurrentRegionalData","regions","id","regionid","name","shortname","intensity","index","forecast","datainfo","allForecast","calTextLevel","determinGran","newGrand","formatFuelMix","array","obj","label","perc","fuel","angle","className","tableText","aggForecast","inputArray","granularity","timeline","forecastArray","forecastArrayFuelMix","slice","agged","half","from","chartData","generationmix","best","objArray","day","parseInt","night","bestDay","sort","b","bestNight","updateRegion","newRegion","updatePostCode","newPostCode","updatePeriod","newPeriod","setInterval","prevProps","prevState","display","minHeight","flexDirection","flex","maxWidth","toFixed"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport logo from './logo.svg';\nimport {\n  BrowserRouter as Router,\n  Switch,\n  Route\n} from \"react-router-dom\";\nimport './App.css';\nimport API from './adapters/API'\nimport Nav from './components/Nav';\nimport Start from './components/Start';\nimport Forecast from './components/Forecast';\nimport Timeline from './components/Timeline';\nimport Hero from './components/Hero';\nimport About from './components/About';\nimport Advice from './components/Advice';\nimport FuelMix from './components/FuelMix';\nimport Footer from './components/Footer';\nimport ScrollToTop from './components/ScrollToTop';\nimport { ItemMeta, Header, Transition } from 'semantic-ui-react';\nimport { cloneWithoutLoc } from '@babel/types';\n\nimport { Container } from 'semantic-ui-react'\n\n\nexport class App extends Component {\n  \n  \n  state = {\n    mobileUser: false,\n    screenWidth:  400,\n    setRegion: 18,\n    setPostCode: '',\n    useId: true,\n    setPeriod: 12,\n    setGran: 2,\n    mediumVal: 150,\n    middle: 150,\n    emissions: 0,\n    regionIndex: [],\n    currentLevel: {region: '', text: '', value: 0},\n    forecastA: {},\n    forecastB: {},\n    forecastC: {},\n    aggedVals: [],\n    bestPeriods: {},\n    fuelMix: [],\n    timelineVals: [],\n    loading:true,\n    currentRegionName: 'GB'\n  }\n  \n  \n//2017-08-25T12:35Z\n//[{id: 0, name: 'test'}]\n\nnow = () => {\n  let date = new Date();\n  return date.toISOString()\n}\n\nviewport = () => {\nlet e = window\nlet a = 'inner';\nif ( !( 'innerWidth' in window ) )\n{\na = 'client';\ne = document.documentElement || document.body;\n}\nlet dimentions = { width : e[ a+'Width' ] , height : e[ a+'Height' ] }\n\nthis.setState({\n  screenWidth: dimentions.width\n})\nif (dimentions.width < 600) {\n  this.setState({mobileUser: true,\n  })\n}\n}\n\ncalMediumLevel = () => {\n\n  let set = this.state.timelineVals.map(item => item.level)\n  let sum = set.reduce((acc, cur) => acc + cur)\n  //console.log(sum)\n  let avg = sum / set.length\n  \n  this.setState({\n  mediumVal: Math.round(avg)\n  })\n}\n\ncalMiddle = () => {\n  let set = this.state.timelineVals.map(item => item.level)\n  let big = set.reduce((acc, cur) => {\n    if (cur > acc){  \n    acc = cur}\n  })\n  //console.log(sum)\n  let avg = big / 2\n  this.setState({\n  middle: Math.round(avg)\n  })\n}\n\n\nplus30Mins = (dateTime) => {\n  let newTime = dateTime.split(/\\D+/);\n  let output =  new Date(Date.UTC(newTime[0], newTime[1]-1, newTime[2], newTime[3], newTime[4], newTime[5]));\n  output.setMinutes(output.getMinutes() + 30)\n  let newdateTime = output.toISOString()\n  return newdateTime\n}\n\nloading = () => {\n  if (typeof this.state.forecastC[0] === 'undefined') {\n    console.log('loading check')\n    this.setState({loading:true})\n  }else {this.setState({loading:false})}\n}\n\n  componentDidMount () {\n    this.loading()\n    this.viewport()\n    this.get48hForecast(this.now(),true)\n    this.compileRegionIndex()\n    {setInterval(() => {this.countEmmissions()},500)}\n    \n  }\n\n\n  \n\n  componentDidUpdate (prevProps, prevState) {\n    if (this.state.setRegion !== prevState.setRegion){\n      this.get48hForecast(this.now(),true)\n      this.compileRegionIndex()\n      this.setState({useId:true})\n    }\n    else if (this.state.setPostCode !== prevState.setPostCode){\n      this.get48hForecast(this.now(),false)\n      this.setState({useId:false})\n    }\n    else if (this.state.forecastA !== prevState.forecastA)\n    {\n      return this.getForecastB(this.state.setRegion)\n    }\n    else if (this.state.forecastB !== prevState.forecastB)\n    {\n      return this.getForecastC(this.state.setRegion)\n    }\n    else if (this.state.forecastC !== prevState.forecastC)\n    {\n      return (\n        this.aggForecast(this.allForecast(), this.determinGran(), false),\n        this.aggForecast(this.allForecast(), 2, true),\n        this.loading()\n        )\n    }\n    else if (this.state.setPeriod !== prevState.setPeriod)\n    {\n      return (\n      this.aggForecast(this.allForecast(), this.determinGran()))\n    }\n    else if (this.state.timelineVals !== prevState.timelineVals) {\n      return (\n        this.calMediumLevel(),\n        this.calMiddle()\n      )\n    }\n  }\n\n  countEmmissions = () => {\n    let count = this.state.emissions += 0.0142\n    this.setState({emissions: count})\n  }\n  \nget48hForecast = (start, useID) => {\n  if (this.state.useId && useID){\n    this.setState({loading:true})\n    API.getRegionId48HrsData(this.state.setRegion, start).then(info => this.setState({forecastA: info.data.data}))\n  }else {\n    // API.getRegionPostCode48HrsData(this.state.setPostCode, start).then(info => this.setState({forecastA: info.data.data}, {setRegion: info.data.regionid}))\n    this.setState({loading:true})\n    API.getRegionPostCode48HrsData(this.state.setPostCode, start).then(info => this.setState({forecastA: info.data.data}))\n  }\n}\ngetForecastB = () => {\n  const start = this.state.forecastA[this.state.forecastA.length - 1].to\n  const startPlus30 = this.plus30Mins(start)\n  console.log(startPlus30)\n  if (this.state.useId) {\n    API.getRegionId48HrsData(this.state.setRegion, startPlus30).then(info => this.setState({forecastB: info.data.data}))\n}else{\n    API.getRegionPostCode48HrsData(this.state.setPostCode, startPlus30).then(info => this.setState({forecastB: info.data.data}))\n  } \n}\ngetForecastC = () => {\n  const start = this.state.forecastB[this.state.forecastB.length - 1].to\n  const startPlus30 = this.plus30Mins(start)\n  if (this.state.useId) {\n    API.getRegionId48HrsData(this.state.setRegion, startPlus30).then(info => this.setState({forecastC: info.data.data, loding:false}))\n}else{\n    API.getRegionPostCode48HrsData(this.state.setPostCode, startPlus30).then(info => this.setState({forecastC: info.data.data, loading:false}))\n  } \n}\n\n\n\n  compileRegionIndex = () => {\n  \n    this.setState({regionIndex: []})\n    API.getCurrentRegionalData().then(info => info.data[0].regions.map(item => {\n          this.setState({\n              regionIndex: \n                [...this.state.regionIndex,\n                {id: item.regionid,\n                name: item.shortname}],\n                }\n          )\n          if (item.regionid === this.state.setRegion){\n            this.setState({\n              currentLevel: {region: item.regionid, text: item.intensity.index, value: item.intensity.forecast},\n              currentRegionName:item.shortname\n            })\n          }\n       }\n      )\n    ).then(datainfo => console.log(datainfo))\n}\n  \n\nallForecast = () => {\n  const allForecast = [...this.state.forecastA, ...this.state.forecastB, ...this.state.forecastC]\n  return allForecast\n}\n\ncalTextLevel = (value) => {\n  if (value > 360) {\n      return 'Very High'\n  } \n  else if (value >= 260 && value <= 359 ) {\n      return 'High'\n  }\n  else if (value >= 160 && value <= 259 ) {\n      return 'Moderate'\n  } \n  else if (value >= 60 && value <= 159 ) {\n    return 'Low'\n  }\n  else if (value <= 59 && value >= 0 ) {\n    return 'Very Low'\n  }else \n  {\n    return 'Level not known'\n  }\n}\n\ndeterminGran = () => {\n let newGrand = 2\n  if (this.state.setPeriod <= 8) {\n    newGrand = 2\n  }else if (this.state.setPeriod > 8 && this.state.setPeriod <= 12) {\n    newGrand = 2\n  }else if (this.state.setPeriod > 12 && this.state.setPeriod <= 24) {\n    newGrand = 2\n  }else if (this.state.setPeriod > 24 && this.state.setPeriod <= 48) {\n    newGrand = 2\n  }else if (this.state.setPeriod > 48 && this.state.setPeriod <= 96) {\n    newGrand = 4\n  }else if (this.state.setPeriod > 200) {\n    newGrand = 6\n  }\n  this.setState({setGran: newGrand})\n  return newGrand\n}\n\nformatFuelMix = (array) => {\n  return array.map(obj => {\n    //return {label: obj.perc > 1 && obj.fuel !== 'biomass' ? obj.fuel : '.   biomass'\n    //return {label: obj.perc > 1 ? obj.fuel : ''\n    return {label: obj.perc > 1 ? obj.fuel === 'biomass' ? 'bio' : obj.fuel : ''\n      ,angle: obj.perc\n      ,className: `${obj.fuel}Wedge`\n      ,tableText: obj.fuel\n    //  ,subLabel: obj.fuel === 'biomass' ? 'biomass' : ''    \n    }\n\n  })\n}\n\naggForecast = (inputArray, granularity, timeline) => {\n \n  // const period = 8\n  // const periodUnits = 'h'\n  // const granularity = 4\n  // const forecastArray =[2,3,6,1,5,1,1,1,1,1,1,10]\n\n  let forecastArray = []\n  let forecastArrayFuelMix = []\n  \n\n  if (timeline) {\n  forecastArray = [...inputArray]\n  }else{\n  forecastArray = inputArray.slice(0, this.state.setPeriod)\n  forecastArrayFuelMix = [...inputArray]\n}\n\n\n\nlet agged = []\n\nfor (let index = 0; index < forecastArray.length; index+=granularity) {\n \n  if (index%granularity === 0) {\n  const half = forecastArray[index];\n  let set = forecastArray.slice(index, index+granularity).map(item => item.intensity.forecast)\n      //console.log(set)\n  let sum = set.reduce((acc, cur) => acc + cur)\n      //console.log(sum)\n      let avg = sum / set.length\n  agged = [...agged, {from:half.from, level:Math.round(avg), text:this.calTextLevel(avg)}]\n}\n}\n\nlet fuelMix = []\n\nfor (let index = 0; index < forecastArrayFuelMix.length; index+=2) {\n \n  if (index%2 === 0) {\n  const half = forecastArrayFuelMix[index];\n  let set = forecastArrayFuelMix.slice(index, index+2).map(item => item.intensity.forecast)\n      //console.log(set)\n  let sum = set.reduce((acc, cur) => acc + cur)\n      //console.log(sum)\n      let avg = sum / set.length\n    fuelMix = [...fuelMix, {date:half.from, level:Math.round(avg), \n    text:this.calTextLevel(avg),\n    chartData: this.formatFuelMix(half.generationmix)\n  }]\n}\n}\n\n\n\n//let newAgged = agged.slice(0, this.state.setPeriod)\n\n\nif (timeline){\n  this.setState({\n    timelineVals: agged,\n  })\n}else {\n  \nlet best = this.bestPeriods(agged)\n\nthis.setState({\n  aggedVals: agged,\n  bestPeriods: best,\n  fuelMix: fuelMix\n})\n}\n//console.log(agged)\n//return agged\n}\n\n\n\n\nbestPeriods = (objArray) => {\n\nlet day = objArray.map(item => {\n  if (parseInt(item.from.split('T')[1]) >= 6 && parseInt(item.from.split('T')[1]) <= 23){\n    return item\n  } \n})\n\nlet night = objArray.map(item => {\n  if (parseInt(item.from.split('T')[1]) < 6 || parseInt(item.from.split('T')[1]) === 24){\n    return item\n  } \n})\n\nlet bestDay = day.sort((a, b) => (a.level > b.level) ? 1 : -1).slice(0,3)\nlet bestNight = night.sort((a, b) => (a.level > b.level) ? 1 : -1).slice(0,3)\n\nreturn {day:bestDay, night:bestNight}\n\n}\n\nupdateRegion = (newRegion) => {\nthis.setState({setRegion: newRegion})\n}\n\nupdatePostCode = (newPostCode => {\n  this.setState({setPostCode: newPostCode})\n})\nupdatePeriod = (newPeriod) => {\nthis.setState({setPeriod: newPeriod})\n}\n\n\n\n  render() {\n    return (\n\n\n<Router>\n  \n<ScrollToTop />\n \n\n<div>\n\n<Hero mobileUser={this.state.mobileUser}/>\n\n<Nav/>\n\n<div style={{ display:\"flex\", minHeight:\"100vh\", flexDirection:\"column\" }}>\n\n<div style={{ flex:1 }}>\n\n<Container className=\"parentContainer\" style={{maxWidth: '80vw'}} >\n\n<Switch>\n\n    <Route exact path=\"/\">\n          <Start intensityData={this.state.currentLevel} emissions={this.state.emissions.toFixed(4)} regionName={this.state.currentRegionName}/>\n    </Route>\n    <Route path=\"/start\" >\n          <Start intensityData={this.state.currentLevel} emissions={this.state.emissions.toFixed(4)} regionName={this.state.currentRegionName}/>\n    </Route>\n    <Route path=\"/forecast-summary\">\n    <Transition visible={true} animation='scale' duration={500}>\n          <Forecast regionIndex={this.state.regionIndex} setRegion={this.state.setRegion} updatePostCode={this.updatePostCode} setPeriod={this.state.setPeriod}\n                    updateRegion={this.updateRegion} updatePeriod={this.updatePeriod} aggedVals={this.state.aggedVals} setPostCode={this.state.setPostCode}\n                    mobileUser={this.state.mobileUser} bestPeriods={this.state.bestPeriods} loading={this.state.loading} useId={this.state.useId} regionName={this.state.currentRegionName}\n          />\n          </Transition>\n    </Route>\n    <Route path=\"/forecast-timeline\">\n          <Timeline loading={this.state.loading} timelineVals={this.state.timelineVals} screenWidth={this.state.screenWidth} middleLevel={this.state.middle} mobileUser={this.state.mobileUser}/>\n    </Route>\n      <Route path=\"/forecast-fuelmix\">\n      <FuelMix loading={this.state.loading} data={this.state.fuelMix} mobileUser={this.state.mobileUser}/>\n\n      </Route>\n\n\n    {/* <Route path=\"/advice\">\n          <Advice />\n    </Route> */}\n    <Route path=\"/about\">\n          <About />\n    </Route>\n\n</Switch>\n      \n\n</Container>\n</div>\n\n\n  \n  <Footer emissions={this.state.emissions.toFixed(4)}/>\n\n</div>\n\n</div>\n\n\n</Router>\n\n    );\n  }\n}\n\nexport default App;\n\n\n\n\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}